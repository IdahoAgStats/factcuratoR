<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Example of the cultivar matching process • factcuratoR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Example of the cultivar matching process">
<meta property="og:description" content="factcuratoR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">factcuratoR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/example_cultivar_matching.html">Example of the cultivar matching process</a>
    </li>
    <li>
      <a href="../articles/intro_codebooks.html">Introduction to the codebook structure</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Example of the cultivar matching process</h1>
                        <h4 data-toc-skip class="author">Jacqueline Tay</h4>
            
            <h4 data-toc-skip class="date">2022-01-10</h4>
      
      
      <div class="hidden name"><code>example_cultivar_matching.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">factcuratoR</span><span class="op">)</span>

<span class="va">codebook_folder</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"tests/testthat/test_controlled_vocab"</span><span class="op">)</span>
<span class="va">example_folder</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"inst/extdata/example_cultivar_matching"</span><span class="op">)</span>
<span class="va">knitroutputfolder</span> <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html" class="external-link">here</a></span><span class="op">(</span><span class="va">example_folder</span>, <span class="st">"output"</span><span class="op">)</span>
<span class="va">auxiliary_files</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html" class="external-link">here</a></span><span class="op">(</span><span class="va">example_folder</span>, <span class="st">"auxiliary_files"</span><span class="op">)</span></code></pre></div>
<div class="section level1">
<h1 id="read-in-raw-variety-names">Read in raw variety names<a class="anchor" aria-label="anchor" href="#read-in-raw-variety-names"></a>
</h1>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">var</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/readr/man/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html" class="external-link">here</a></span><span class="op">(</span><span class="va">example_folder</span>, <span class="st">"example_cultivar_matching.csv"</span><span class="op">)</span>, 
            col_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/readr/man/cols.html" class="external-link">cols</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">var</span><span class="op">)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="24%">
<col width="8%">
<col width="6%">
<col width="60%">
</colgroup>
<thead><tr class="header">
<th align="left">variety</th>
<th align="left">crop_type</th>
<th align="left">nursery</th>
<th align="left">behavior_to_test</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Wildfile (W512)</td>
<td align="left">wheat</td>
<td align="left">HRW</td>
<td align="left">main name is misspelled, so do.exactmatch matches the alias</td>
</tr>
<tr class="even">
<td align="left">wildfir</td>
<td align="left">wheat</td>
<td align="left">HRW</td>
<td align="left">misspelling that won’t exact match</td>
</tr>
<tr class="odd">
<td align="left">AAC wildfire</td>
<td align="left">wheat</td>
<td align="left">H_W</td>
<td align="left">Exact match</td>
</tr>
<tr class="even">
<td align="left">AAC wildfire (W512)</td>
<td align="left">wheat</td>
<td align="left">HRW</td>
<td align="left">both names will exact match and the alias will be moved to “not needed”</td>
</tr>
<tr class="odd">
<td align="left">W512</td>
<td align="left">wheat</td>
<td align="left">H_W</td>
<td align="left">exact match with alias</td>
</tr>
<tr class="even">
<td align="left">W512</td>
<td align="left">wheat</td>
<td align="left">HRW</td>
<td align="left">duplicate of W512 with different nursery</td>
</tr>
<tr class="odd">
<td align="left">new name 101 (alias name101)</td>
<td align="left">wheat</td>
<td align="left">SWW</td>
<td align="left">new name with alias</td>
</tr>
<tr class="even">
<td align="left">New 101</td>
<td align="left">wheat</td>
<td align="left">S_W</td>
<td align="left">duplicate to (new name 1) but very different naming</td>
</tr>
<tr class="odd">
<td align="left">new101</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">same internal id as New 1</td>
</tr>
<tr class="even">
<td align="left">new name 201</td>
<td align="left">wheat</td>
<td align="left">SWW</td>
<td align="left">new name</td>
</tr>
<tr class="odd">
<td align="left">Name 201</td>
<td align="left">wheat</td>
<td align="left">SWW</td>
<td align="left">duplicate to (new name 2) but slightly different naming</td>
</tr>
<tr class="even">
<td align="left">WA008123</td>
<td align="left">wheat</td>
<td align="left">NA</td>
<td align="left">test fuzzymatching with numbers and leading zeros</td>
</tr>
<tr class="odd">
<td align="left">melbclub</td>
<td align="left">wheat</td>
<td align="left">NA</td>
<td align="left">test that fuzzymatching returns the correct fuzzymatches</td>
</tr>
<tr class="even">
<td align="left">wb1035cl</td>
<td align="left">wheat</td>
<td align="left">NA</td>
<td align="left">test fuzzymatching with numbers</td>
</tr>
<tr class="odd">
<td align="left">455</td>
<td align="left">wheat</td>
<td align="left">NA</td>
<td align="left">test fuzzymatching with numbers</td>
</tr>
</tbody>
</table>
</div>
<div class="section level1">
<h1 id="cultivar-matching">Cultivar matching<a class="anchor" aria-label="anchor" href="#cultivar-matching"></a>
</h1>
<div class="section level2">
<h2 id="create-unique-internal-id-for-names">Create unique internal id for names<a class="anchor" aria-label="anchor" href="#create-unique-internal-id-for-names"></a>
</h2>
<p>Note!: Once the fuzzymatching stage is started, it is important that the var_id doesn’t change other it will cause problems with matching up matches with the correct names</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">names_raw</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/create_intid.html">create_intid</a></span><span class="op">(</span><span class="va">var</span>, 
               <span class="va">variety</span>, 
               sep_aliases <span class="op">=</span> <span class="st">"\\("</span>, 
               <span class="va">crop_type</span>, 
               <span class="va">nursery</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>var_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">var_id</span><span class="op">)</span><span class="op">)</span><span class="co">#, </span>
               <span class="co">#alias_col = alias)</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">names_raw</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">variety</th>
<th align="left">crop_type</th>
<th align="left">nursery</th>
<th align="left">type</th>
<th align="left">intid</th>
<th align="left">var_id</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">455</td>
<td align="left">wheat</td>
<td align="left">NA</td>
<td align="left">variety</td>
<td align="left">455</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">AAC wildfire</td>
<td align="left">wheat</td>
<td align="left">H_W</td>
<td align="left">variety</td>
<td align="left">aacwildfire</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">AAC wildfire (W512)</td>
<td align="left">wheat</td>
<td align="left">HRW</td>
<td align="left">variety</td>
<td align="left">aacwildfire</td>
<td align="left">3</td>
</tr>
<tr class="even">
<td align="left">AAC wildfire (W512)</td>
<td align="left">wheat</td>
<td align="left">HRW</td>
<td align="left">alias</td>
<td align="left">w512</td>
<td align="left">3</td>
</tr>
<tr class="odd">
<td align="left">melbclub</td>
<td align="left">wheat</td>
<td align="left">NA</td>
<td align="left">variety</td>
<td align="left">melbclub</td>
<td align="left">4</td>
</tr>
<tr class="even">
<td align="left">Name 201</td>
<td align="left">wheat</td>
<td align="left">SWW</td>
<td align="left">variety</td>
<td align="left">name201</td>
<td align="left">5</td>
</tr>
<tr class="odd">
<td align="left">New 101</td>
<td align="left">wheat</td>
<td align="left">S_W</td>
<td align="left">variety</td>
<td align="left">new101</td>
<td align="left">6</td>
</tr>
<tr class="even">
<td align="left">new name 101 (alias name101)</td>
<td align="left">wheat</td>
<td align="left">SWW</td>
<td align="left">variety</td>
<td align="left">newname101</td>
<td align="left">7</td>
</tr>
<tr class="odd">
<td align="left">new name 101 (alias name101)</td>
<td align="left">wheat</td>
<td align="left">SWW</td>
<td align="left">alias</td>
<td align="left">aliasname101</td>
<td align="left">7</td>
</tr>
<tr class="even">
<td align="left">new name 201</td>
<td align="left">wheat</td>
<td align="left">SWW</td>
<td align="left">variety</td>
<td align="left">newname201</td>
<td align="left">8</td>
</tr>
<tr class="odd">
<td align="left">new101</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">variety</td>
<td align="left">new101</td>
<td align="left">9</td>
</tr>
<tr class="even">
<td align="left">W512</td>
<td align="left">wheat</td>
<td align="left">H_W;HRW</td>
<td align="left">variety</td>
<td align="left">w512</td>
<td align="left">10</td>
</tr>
<tr class="odd">
<td align="left">WA008123</td>
<td align="left">wheat</td>
<td align="left">NA</td>
<td align="left">variety</td>
<td align="left">wa008123</td>
<td align="left">11</td>
</tr>
<tr class="even">
<td align="left">wb1035cl</td>
<td align="left">wheat</td>
<td align="left">NA</td>
<td align="left">variety</td>
<td align="left">wb1035cl</td>
<td align="left">12</td>
</tr>
<tr class="odd">
<td align="left">Wildfile (W512)</td>
<td align="left">wheat</td>
<td align="left">HRW</td>
<td align="left">variety</td>
<td align="left">wildfile</td>
<td align="left">13</td>
</tr>
<tr class="even">
<td align="left">Wildfile (W512)</td>
<td align="left">wheat</td>
<td align="left">HRW</td>
<td align="left">alias</td>
<td align="left">w512</td>
<td align="left">13</td>
</tr>
<tr class="odd">
<td align="left">wildfir</td>
<td align="left">wheat</td>
<td align="left">HRW</td>
<td align="left">variety</td>
<td align="left">wildfir</td>
<td align="left">14</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="do-exact-match">Do exact match<a class="anchor" aria-label="anchor" href="#do-exact-match"></a>
</h2>
<p>The first step is to exact match to the cultivar names in the codebooks The second step is to exact match to the names in the</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results_exactmatch</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/do_exactmatch.html">do_exactmatch</a></span><span class="op">(</span>db_folder <span class="op">=</span> <span class="va">codebook_folder</span>,
                data_intid <span class="op">=</span> <span class="va">names_raw</span>,
                select_before <span class="op">=</span> <span class="st">"2021-11-22"</span>,
                match_type <span class="op">=</span> <span class="st">"raw"</span><span class="op">)</span>
<span class="co">#&gt; This function name is being retained for backwards compatibility.</span>
<span class="co">#&gt;           Please use get_variety_db()</span>
<span class="co">#&gt; match: 5 nomatch: 10 check: 0 not_needed: 2</span>

<span class="va">results_rename</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/do_exactmatch.html">do_exactmatch</a></span><span class="op">(</span>db_folder <span class="op">=</span> <span class="va">codebook_folder</span>, 
                data_intid <span class="op">=</span> <span class="va">results_exactmatch</span><span class="op">$</span><span class="va">nomatch</span>, 
                match_type <span class="op">=</span> <span class="st">"raw"</span>, 
                rename_df <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; This function name is being retained for backwards compatibility.</span>
<span class="co">#&gt;           Please use readin_db()</span>
<span class="co">#&gt; match: 2 nomatch: 8 check: 0 not_needed: 0</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">results_rename</span><span class="op">[[</span><span class="st">"match"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="7%">
<col width="8%">
<col width="7%">
<col width="7%">
<col width="7%">
<col width="6%">
<col width="9%">
<col width="9%">
<col width="7%">
<col width="7%">
<col width="11%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left">variety</th>
<th align="left">crop_type</th>
<th align="left">nursery</th>
<th align="left">type</th>
<th align="left">intid</th>
<th align="left">var_id</th>
<th align="left">variety_db</th>
<th align="left">wrong_name</th>
<th align="left">db_id</th>
<th align="left">type_db</th>
<th align="left">is_truematch</th>
<th align="left">any_match</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">melbclub</td>
<td align="left">wheat</td>
<td align="left">NA</td>
<td align="left">variety</td>
<td align="left">melbclub</td>
<td align="left">4</td>
<td align="left">Melba</td>
<td align="left">melbclub</td>
<td align="left">melbclub</td>
<td align="left">NA</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">wb1035cl</td>
<td align="left">wheat</td>
<td align="left">NA</td>
<td align="left">variety</td>
<td align="left">wb1035cl</td>
<td align="left">12</td>
<td align="left">WB-1035CL+</td>
<td align="left">WB 1035 CL</td>
<td align="left">wb1035cl</td>
<td align="left">NA</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">results_rename</span><span class="op">[[</span><span class="st">"nomatch"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">variety</th>
<th align="left">crop_type</th>
<th align="left">nursery</th>
<th align="left">type</th>
<th align="left">intid</th>
<th align="left">var_id</th>
<th align="left">wrong_name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Name 201</td>
<td align="left">wheat</td>
<td align="left">SWW</td>
<td align="left">variety</td>
<td align="left">name201</td>
<td align="left">5</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">New 101</td>
<td align="left">wheat</td>
<td align="left">S_W</td>
<td align="left">variety</td>
<td align="left">new101</td>
<td align="left">6</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">new name 101 (alias name101)</td>
<td align="left">wheat</td>
<td align="left">SWW</td>
<td align="left">variety</td>
<td align="left">newname101</td>
<td align="left">7</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">new name 101 (alias name101)</td>
<td align="left">wheat</td>
<td align="left">SWW</td>
<td align="left">alias</td>
<td align="left">aliasname101</td>
<td align="left">7</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">new name 201</td>
<td align="left">wheat</td>
<td align="left">SWW</td>
<td align="left">variety</td>
<td align="left">newname201</td>
<td align="left">8</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">new101</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">variety</td>
<td align="left">new101</td>
<td align="left">9</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">WA008123</td>
<td align="left">wheat</td>
<td align="left">NA</td>
<td align="left">variety</td>
<td align="left">wa008123</td>
<td align="left">11</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">wildfir</td>
<td align="left">wheat</td>
<td align="left">HRW</td>
<td align="left">variety</td>
<td align="left">wildfir</td>
<td align="left">14</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="do-fuzzymatch">Do fuzzymatch<a class="anchor" aria-label="anchor" href="#do-fuzzymatch"></a>
</h2>
<p>The fuzzy matching procedure returns the best fuzzymatches from stringdist_join using two methods (“lv” and “jw”).<br>
The results are filtered for these conditions: - crop_type must match (e.g. wheat vs. barley) - numbers at the end of a variety name must be an exact match</p>
<div class="section level3">
<h3 id="output-file-to-manually-match">Output file to manually match<a class="anchor" aria-label="anchor" href="#output-file-to-manually-match"></a>
</h3>
<p>Fill the is_truematch column with TRUE if fuzzymatch is a true match, otherwise fill with FALSE</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">output_fuzzymatch</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/find_fuzzymatch.html">find_fuzzymatch</a></span><span class="op">(</span><span class="va">results_rename</span><span class="op">$</span><span class="va">nomatch</span> ,
                intid_col <span class="op">=</span> <span class="st">"intid"</span>,
                select_before <span class="op">=</span> <span class="st">"2021-05-26"</span>,
                knitroutputfolder <span class="op">=</span> <span class="va">knitroutputfolder</span><span class="op">)</span>


<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">output_fuzzymatch</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="process-manual-matches">Process manual matches<a class="anchor" aria-label="anchor" href="#process-manual-matches"></a>
</h3>
<p>Read in manual check and output names with no match Return aliases (same var_id) that had matches in the previous steps. These aliases were not in the original database and should be added. If no match or aliases, then generate new cultivar entries for the database. Write out the new names to be standardized/ checked by collaborators</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fuzzy_status</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/readr/man/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span>
    <span class="fu">here</span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="va">auxiliary_files</span><span class="op">)</span>, <span class="st">"fuzzymatch_status.csv"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>var_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">var_id</span><span class="op">)</span><span class="op">)</span>


<span class="va">results_fuzzymatch</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/process_fuzzymatch.html">process_fuzzymatch</a></span><span class="op">(</span>output_fuzzymatch_df <span class="op">=</span> <span class="va">output_fuzzymatch</span>, 
                     aux_fuzzy_status <span class="op">=</span> <span class="va">fuzzy_status</span><span class="op">)</span>

<span class="co"># Go through and standardize the names in standardize_new_names_aux.csv</span>
<span class="co"># If any names are found to already be in the database, then manually</span>
<span class="co"># add them to the controlled_vocab/cv_rename.csv file</span>
<span class="co"># This occurs when the name is not found by fuzzymatching</span>
<span class="va">results_new_names</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/process_std_new_names.html">process_std_new_names</a></span><span class="op">(</span>
    output_nomatch_df <span class="op">=</span> <span class="va">results_fuzzymatch</span><span class="op">[[</span><span class="st">"nomatch"</span><span class="op">]</span><span class="op">]</span>, 
    auxiliary_files <span class="op">=</span> <span class="va">auxiliary_files</span>,  
    filename <span class="op">=</span> <span class="st">"standardize_new_names_aux.csv"</span><span class="op">)</span></code></pre></div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="collect-all-the-matches-from-each-step">Collect all the matches from each step<a class="anchor" aria-label="anchor" href="#collect-all-the-matches-from-each-step"></a>
</h1>
<p>Once the names from the process_std_new_names() step have been added to the cv_rename file, then they should match in the cv_rename step</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">names_matches</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/collect_final_matches.html">collect_final_matches</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>exact <span class="op">=</span> <span class="va">results_exactmatch</span>,
                                            rename <span class="op">=</span> <span class="va">results_rename</span>,
                                 fuzzy <span class="op">=</span> <span class="va">results_fuzzymatch</span><span class="op">)</span>, <span class="va">names_raw</span><span class="op">)</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">names_matches</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="bind-matches-with-the-data">Bind matches with the data<a class="anchor" aria-label="anchor" href="#bind-matches-with-the-data"></a>
</h1>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># pseudocode</span>
<span class="co"># data_cv_names &lt;- left_join(data, names_matches, by = "variety)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jacqueline Tay.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
